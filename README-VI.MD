# ChÆ°Æ¡ng trÃ¬nh quay sá»‘ may máº¯n

ChÆ°Æ¡ng trÃ¬nh quay sá»‘ may máº¯n cho tiá»‡c táº¥t niÃªn, quay sá»‘ quáº£ cáº§u 3D, há»— trá»£ cáº¥u hÃ¬nh thÃ´ng tin giáº£i thÆ°á»Ÿng, nháº­p thÃ´ng tin ngÆ°á»i tham gia báº±ng `Excel`, vÃ  xuáº¥t káº¿t quáº£ quay sá»‘ báº±ng `Excel`

Náº¿u chÆ°Æ¡ng trÃ¬nh nÃ y há»¯u Ã­ch cho báº¡nğŸ˜ğŸ˜ğŸ˜, ráº¥t mong báº¡n cho má»™tâ­**sao**â­ ğŸ˜˜ğŸ˜˜ğŸ˜˜ğŸ˜ğŸ¥°ğŸ‰ğŸˆğŸƒ

> Thá»­ ngay:  [https://moshang-ax.github.io/lottery/](https://moshang-ax.github.io/lottery/)

## CÃ´ng nghá»‡ sá»­ dá»¥ng

CÃ´ng nghá»‡: Node + Express + Three.js

Server: Express + Node

Trang web: Three.js, Tham kháº£o vÃ­ dá»¥ 3D chÃ­nh thá»©c cá»§a `Three.js`

## MÃ´ táº£ chá»©c nÄƒng:

1. Káº¿t quáº£ cÃ³ thá»ƒ Ä‘Æ°á»£c lÆ°u vÃ  táº£i xuá»‘ng excel Ä‘á»“ng bá»™ğŸ‰
2. NgÆ°á»i trÃºng thÆ°á»Ÿng sáº½ khÃ´ng tham gia quay sá»‘ ná»¯a, vÃ  ngÆ°á»i quay sá»‘ cÃ³ thá»ƒ quay láº¡i náº¿u ngÆ°á»i Ä‘Ã³ khÃ´ng cÃ³ máº·t táº¡i chá»—ğŸ
3. LÃ m má»›i hoáº·c táº¯t server sáº½ lÆ°u dá»¯ liá»‡u ngÆ°á»i trÃºng thÆ°á»Ÿng vÃ  sáº½ khÃ´ng Ä‘áº·t láº¡i dá»¯ liá»‡u quay sá»‘, chá»‰ khi nháº¥p vÃ o nÃºt Ä‘áº·t láº¡i trÃªn trang thÃ¬ dá»¯ liá»‡u quay sá»‘ má»›i Ä‘Æ°á»£c Ä‘áº·t láº¡iğŸ§§
4. Sá»‘ lÆ°á»£ng giáº£i thÆ°á»Ÿng cÃ³ thá»ƒ cáº¥u hÃ¬nhğŸˆ
5. Sau khi táº¥t cáº£ giáº£i thÆ°á»Ÿng Ä‘Ã£ Ä‘Æ°á»£c quay, báº¡n cÃ³ thá»ƒ tiáº¿p tá»¥c quay giáº£i Ä‘áº·c biá»‡t (VÃ­ dá»¥: LÃ¬ xÃ¬, giáº£i thÆ°á»Ÿng bá»• sung, v.v.). Máº·c Ä‘á»‹nh, má»™t láº§n quay má»™t giáº£iğŸ§¨

## Xem trÆ°á»›c

> Thá»­ ngay:  [https://moshang-ax.github.io/lottery/](https://moshang-ax.github.io/lottery/)

![lottery.gif](https://raw.githubusercontent.com/moshang-xc/blog/master/share/lottery.gif)

![index.jpg](https://raw.githubusercontent.com/moshang-xc/blog/master/share/index.jpg)

![start.jpg](https://raw.githubusercontent.com/moshang-xc/blog/master/share/start.jpg)

![end.jpg](https://raw.githubusercontent.com/moshang-xc/blog/master/share/end.jpg)

## CÃ i Ä‘áº·t

```
git clone https://github.com/moshang-xc/lottery.git

cd lottery

# CÃ i Ä‘áº·t plugin server
cd server
npm install

# CÃ i Ä‘áº·t plugin front-end
cd ../product
npm install

# ÄÃ³ng gÃ³i
npm run build

# Cháº¡y
npm run serve

# PhÃ¡t triá»ƒn & gá»¡ lá»—i
npm run dev

```

## Cáº¥u trÃºc thÆ° má»¥c

```
Lottery
â”œâ”€â”€ product
â”‚   â”œâ”€â”€ src
â”‚   â”‚   â”œâ”€â”€ lottery
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ lib
â”‚   â”‚   â”œâ”€â”€ img
â”‚   â”‚   â”œâ”€â”€ css
â”‚   â”‚   â””â”€â”€ data
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ webpack.config.js
â”œâ”€â”€ server
â”‚   â”œâ”€â”€ config.js
â”‚   â”œâ”€â”€ server.js
â”‚   â””â”€â”€ package.js
```

> 1. product lÃ  thÆ° má»¥c trang front-end
> 2. package.josn lÃ  file cáº¥u hÃ¬nh dá»± Ã¡n web
> 3. webpack.config.js lÃ  file cáº¥u hÃ¬nh Ä‘Ã³ng gÃ³i
> 4. server lÃ  thÆ° má»¥c server
> 5. config lÃ  file cáº¥u hÃ¬nh thÃ´ng tin giáº£i thÆ°á»Ÿng

## ThÃ´ng tin cáº¥u hÃ¬nh

### Cáº¥u hÃ¬nh thÃ´ng tin ngÆ°á»i dÃ¹ng quay sá»‘

ThÃ´ng tin ngÆ°á»i dÃ¹ng quay sá»‘ trong file**`server/data/user.xlsx`**, Ä‘iá»n theo Ä‘á»‹nh dáº¡ng file, khÃ´ng thá»ƒ sá»­a tÃªn file vÃ  tiÃªu Ä‘á» cá»™t

### Cáº¥u hÃ¬nh thÃ´ng tin giáº£i thÆ°á»Ÿng

ThÃ´ng tin cáº¥u hÃ¬nh giáº£i thÆ°á»Ÿng Ä‘Æ°á»£c Ä‘iá»n trong file**server/config.js**, khÃ´ng thá»ƒ sá»­a tÃªn file.

**MÃ´ táº£ cáº¥u hÃ¬nh giáº£i thÆ°á»Ÿng prizes nhÆ° sau:**

| Tham sá»‘  | Kiá»ƒu giÃ¡ trá»‹ | MÃ´ táº£                                                         |
| ----- | ------ | ------------------------------------------------------------ |
| type  | Number | Loáº¡i giáº£i thÆ°á»Ÿng, mÃ£ Ä‘á»‹nh danh duy nháº¥t, 0 lÃ  placeholder cho giáº£i Ä‘áº·c biá»‡t máº·c Ä‘á»‹nh, cÃ¡c giáº£i thÆ°á»Ÿng khÃ¡c khÃ´ng thá»ƒ sá»­ dá»¥ng |
| count | Number | Sá»‘ lÆ°á»£ng giáº£i thÆ°á»Ÿng                                                     |
| text  | String | TÃªn giáº£i thÆ°á»Ÿng                                                     |
| title | String | MÃ´ táº£ giáº£i thÆ°á»Ÿng                                                     |
| img   | String | Äá»‹a chá»‰ hÃ¬nh áº£nh giáº£i thÆ°á»Ÿng, hÃ¬nh áº£nh trong thÆ° má»¥c**img**                          |

```js
// ThÃ´ng tin giáº£i thÆ°á»Ÿng, má»¥c Ä‘áº§u tiÃªn lÃ  má»¥c dá»± phÃ²ng khÃ´ng thá»ƒ sá»­a, cÃ¡c má»¥c khÃ¡c cÃ³ thá»ƒ sá»­a theo nhu cáº§u
let prizes = [{
        type: 0,
        count: 1000,
        title: "",
        text: "Giáº£i Ä‘áº·c biá»‡t"
    },
    {
        type: 1,
        count: 2,
        text: "Giáº£i Ä‘áº·c biá»‡t",
        title: "QuÃ  táº·ng bÃ­ áº©n",
        img: "../img/secrit.jpg"
    },
    {
        type: 2,
        count: 5,
        text: "Giáº£i nháº¥t",
        title: "Mac Pro",
        img: "../img/mbp.jpg"
    }
    ...
];
```

### Cáº¥u hÃ¬nh sá»‘ lÆ°á»£ng giáº£i thÆ°á»Ÿng quay má»—i láº§n

**EACH_COUNT**DÃ¹ng Ä‘á»ƒ cáº¥u hÃ¬nh sá»‘ lÆ°á»£ng quay sá»‘ má»—i láº§n, tÆ°Æ¡ng á»©ng má»™t-má»™t vá»›i prizes giáº£i thÆ°á»Ÿng, vÃ­ dá»¥ cáº¥u hÃ¬nh sá»‘ lÆ°á»£ng quay sá»‘ tÆ°Æ¡ng á»©ng vá»›i cáº¥u hÃ¬nh giáº£i thÆ°á»Ÿng á»Ÿ trÃªn nhÆ° sau:

```js
const EACH_COUNT = [1, 1, 5];
```

Cáº¥u hÃ¬nh trÃªn cÃ³ nghÄ©a lÃ  sá»‘ lÆ°á»£ng giáº£i thÆ°á»Ÿng quay má»™t láº§n theo thá»© tá»± lÃ : giáº£i Ä‘áº·c biá»‡t má»—i láº§n quay má»™t, giáº£i Ä‘áº·c biá»‡t má»—i láº§n quay má»™t, giáº£i nháº¥t má»—i láº§n quay nÄƒm

### Cáº¥u hÃ¬nh logo cÃ´ng ty

Logo nÃ y dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ trÃªn tháº» quay sá»‘.

```js
const COMPANY = "MoShang";
```


## PhÆ°Æ¡ng Ã¡n triá»ƒn khai Docker

### Tá»•ng quan

Dá»± Ã¡n nÃ y hiá»‡n há»— trá»£ sá»­ dá»¥ng Docker Ä‘á»ƒ triá»ƒn khai. Docker lÃ  má»™t ná»n táº£ng container hÃ³a nháº¹, cho phÃ©p báº¡n triá»ƒn khai, kiá»ƒm thá»­ vÃ  cháº¡y á»©ng dá»¥ng má»™t cÃ¡ch nhanh chÃ³ng. TÃ i liá»‡u nÃ y sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch sá»­ dá»¥ng Docker Ä‘á»ƒ triá»ƒn khai dá»± Ã¡n.

### YÃªu cáº§u há»‡ thá»‘ng

TrÆ°á»›c khi báº¯t Ä‘áº§u sá»­ dá»¥ng Docker Ä‘á»ƒ triá»ƒn khai dá»± Ã¡n, báº¡n cáº§n Ä‘áº£m báº£o Ä‘Ã£ cÃ i Ä‘áº·t cÃ¡c pháº§n má»m sau:

- Docker (Vui lÃ²ng tham kháº£o tÃ i liá»‡u chÃ­nh thá»©c cá»§a Docker Ä‘á»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t)
- Docker Compose

### CÃ i Ä‘áº·t

1. Táº£i xuá»‘ng vÃ  giáº£i nÃ©n mÃ£ nguá»“n cá»§a dá»± Ã¡n.

2. VÃ o thÆ° má»¥c dá»± Ã¡n sau khi giáº£i nÃ©n.

3. Thá»±c thi lá»‡nh sau Ä‘á»ƒ xÃ¢y dá»±ng Docker image:

   ```
   ./build.sh [TAG]
   ```

   Äiá»u nÃ y sáº½ sá»­ dá»¥ng Dockerfile Ä‘á»ƒ xÃ¢y dá»±ng má»™t Docker image cÃ³ tÃªn`lottery:[TAG]`. Náº¿u khÃ´ng chá»‰ Ä‘á»‹nh tag, máº·c Ä‘á»‹nh sáº½ sá»­ dá»¥ng tag`latest`.

4. Thá»±c thi lá»‡nh sau Ä‘á»ƒ cháº¡y container cá»¥c bá»™:

   ```
   ./dev.sh [TAG]
   ```

   Äiá»u nÃ y sáº½ khá»Ÿi Ä‘á»™ng container vÃ  triá»ƒn khai á»©ng dá»¥ng trong Docker container. Báº¡n cÃ³ thá»ƒ kiá»ƒm thá»­ cá»¥c bá»™ Ä‘á»ƒ Ä‘áº£m báº£o má»i thá»© hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng. LÆ°u Ã½ ráº±ng á»©ng dá»¥ng trong container sáº½ láº¯ng nghe cá»•ng 8888 vÃ  cá»•ng 443.

5. Thá»±c thi lá»‡nh sau Ä‘á»ƒ Ä‘Ã¡nh dáº¥u Docker image vÃ  Ä‘áº©y lÃªn Docker repository tá»« xa:

   ```
   ./tagpush.sh [TAG]
   ```

   Äiá»u nÃ y sáº½ Ä‘Ã¡nh dáº¥u Docker image vÃ  Ä‘áº©y lÃªn Docker repository tá»« xa, náº¿u muá»‘n sá»­ dá»¥ng docker hub chÃ­nh thá»©c, vui lÃ²ng táº¡o repo cá»§a riÃªng báº¡n táº¡i https://hub.docker.com/ trÆ°á»›c, sau Ä‘Ã³ thay Ä‘á»•i tÃªn ngÆ°á»i dÃ¹ng trong file thÃ nh cá»§a báº¡n. LÆ°u Ã½ ráº±ng,`[TAG]`nÃªn Ä‘Æ°á»£c thay tháº¿ báº±ng tÃªn tag báº¡n muá»‘n sá»­ dá»¥ng.

6. Äáº£m báº£o cÃ³ má»™t file cÃ³ tÃªn`docker-compose.yml`vÃ  thÃªm ná»™i dung sau:

   ```
   version: '3.8'
   
   volumes:
     lottery_log:
   
   services:
     lottery:
       container_name: lottery
       expose:
         - 8888
       ports:
         - "28458:8888"
         - "443:443"
       volumes:
         - "lottery_log:/var/log"
       image: "panda1024/lottery:[TAG]" 
       restart: always
   ```

   LÆ°u Ã½ ráº±ng,`[TAG]`nÃªn Ä‘Æ°á»£c thay tháº¿ báº±ng tÃªn image báº¡n Ä‘Ã£ Ä‘áº©y lÃªn Docker repository.

7. Trong thÆ° má»¥c dá»± Ã¡n trÃªn server, cháº¡y lá»‡nh sau Ä‘á»ƒ sá»­ dá»¥ng Docker Compose triá»ƒn khai á»©ng dá»¥ng:

```
	docker-compose up -d
```

â€‹		Äiá»u nÃ y sáº½ khá»Ÿi Ä‘á»™ng má»™t Docker Compose stack vÃ  triá»ƒn khai dá»± Ã¡n trong Ä‘Ã³. LÆ°u Ã½ ráº±ng, á»Ÿ Ä‘Ã¢y cá»•ng 8888 vÃ  cá»•ng 443 cá»§a container Ä‘Æ°á»£c Ã¡nh xáº¡ Ä‘áº¿n cá»•ng 8888 vÃ  cá»•ng 443 trÃªn server. Náº¿u báº¡n muá»‘n sá»­ dá»¥ng cá»•ng khÃ¡c, vui lÃ²ng thay Ä‘á»•i file`docker-compose.yml`tÆ°Æ¡ng á»©ng.



## License

MIT

